<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인명구조함 지도 (카카오)</title>
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=YOUR_KAKAO_APP_KEY&libraries=clusterer"></script>
    <style>
        html, body, #map { width: 100%; height: 100%; margin: 0; padding: 0; }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        var map = new kakao.maps.Map(document.getElementById("map"), {
            center: new kakao.maps.LatLng(37.5665, 126.978), // 서울 위치
            level: 5,
        });

        // 내 위치 추적
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var lat = position.coords.latitude;
                var lon = position.coords.longitude;

                var marker = new kakao.maps.Marker({
                    position: new kakao.maps.LatLng(lat, lon),
                    map: map,
                });

                var requestData = {
                    lat: lat,
                    lon: lon,
                    timestamp: Date.now(),
                };

                // 구조 요청 보내기
                fetch("https://kcg-lifesaver.koyeb.app/request-help", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(requestData),
                })
                .then(response => response.json())
                .then(data => console.log(data))
                .catch(error => console.error("Error:", error));
            });
        }
    </script>
</body>
</html>
